/**
 * @module 请求错误类型定义
 * 
 * 本模块定义了请求库中的统一错误格式，为整个请求系统提供了标准化的错误处理机制。
 * 通过封装原始错误、请求配置和可能的响应信息，支持插件系统和应用代码进行
 * 灵活的错误处理、恢复和转换操作。
 */

import { RequestConfig } from "./RequestConfig"
import { Response } from "./Response"

/**
 * 请求错误接口
 * 
 * 该接口定义了请求库中的统一错误格式，封装了原始错误对象、请求配置和可能的响应信息，
 * 便于插件系统和应用代码进行错误处理和恢复操作。这个统一的错误格式使错误处理逻辑
 * 更加一致和可维护，同时为错误恢复提供了必要的上下文信息。
 * 
 * @template T - 响应数据的类型参数，用于在错误处理中提供可能的恢复数据类型
 * @template C - 请求配置类型，必须继承自RequestConfig，支持特定插件的自定义配置项
 */
export interface RequestError<T = any, C extends RequestConfig = RequestConfig> {
    /**
     * 原始错误对象
     * 
     * 捕获的具体错误，可以是任意类型，包括网络错误、服务器错误、自定义错误等。
     * 此属性保存了底层错误的完整信息，便于调试和详细错误分析。
     */
    error: unknown

    /**
     * 请求配置对象
     * 
     * 包含触发错误的请求的完整配置信息，包括URL、方法、请求头、请求体等。
     * 此属性对于实现重试逻辑、错误日志记录和请求诊断非常重要。
     */
    config: C

    /**
     * 服务器响应对象（可选）
     * 
     * 如果请求已发送并收到服务器响应（即使状态码表示错误，如4xx、5xx），则包含此属性。
     * 在错误处理插件中，如果设置了该属性，请求核心会直接中断错误处理流程并将其视为成功响应返回，
     * 这是实现错误恢复机制的关键。
     */
    response?: Response<T, C>
}